import{u as F,r as n,w as E,o as T,a as V,b as c,c as a,d as l,e as $,t as h,f as Q,g as z,h as v,i as m,j as f,F as G,k as J,l as C,m as N,n as S,p as K,q as R}from"./index.f9dfb1df.js";const W={__name:"mCustomer",props:{custID:[Number,String]},setup(y){const r=y,{getCustomer:w}=F(),g=n({}),d=async s=>{let o=await w(s);console.log("loadCustomer",o),g.value=o};return E(()=>r.custID,async(s,o)=>{console.log("watch props.custID",s,o),d(s)}),T(async()=>{console.log("customerMounted",r.custID),d(r.custID)}),(s,o)=>{const p=V("auto-animate");return c((a(),l("div",null,[c((a(),l("pre",null,[$(h(g.value),1)])),[[p]])])),[[p]])}}};const X={class:"mCustomerSearch"},Y={class:"p-input-icon-left mb-0",style:{width:"100%"}},Z=f("i",{class:"pi pi-search"},null,-1),ee={class:"m-List p-component"},te=["onClick"],se={class:"m-List-Item-Header"},ae={class:"m-List-Item-SubHeader"},oe=f("hr",{class:"m-List-Item-Line mx-1 mb-0"},null,-1),ne={key:1},le={__name:"mCustomerSearch",setup(y){const{createCustomer:r,getCustomers:w,searchCustomers:g}=F(),d=Q(),{debounce:s}=z(),o=n(""),p=n(!1);T(async()=>{u.value={...B.value}});const B=n({page:0,rows:10,first:0,pageCount:0,totalRecords:0}),u=n({}),A=async _=>{console.log("pagechange",_),u.value.page=_.page,k()},U=async()=>{s(async()=>{u.value={...B.value},o.value===""?x.value=[]:(p.value=!0,await k(),p.value=!1)})},k=async()=>{const _=u.value,t=_.page*_.rows,b=t+_.rows-1,{data:D,count:I}=await g(o.value,{range:{from:t,to:b},order:{column:"lastName",ascending:!0}});return x.value=D,u.value.totalRecords=I,!0},x=n([]),O=n([{type:"title",label:"Customers"},{type:"spacer"},{type:"Button",label:"",icon:"pi pi-plus",class:"p-button-success ",callback:()=>{i.value={...P.value}}}]),i=n({show:!1,header:"Add Customer",slot:"addCustomer"}),H=n({show:!1,header:"Add Customer",slot:"addCustomer"}),P=n({show:!0,header:"Add Customer",slot:"addCustomer",customerData:{},formItems:[{key:"firstName",label:"First Name",type:"text"},{key:"lastName",label:"Last Name",type:"text"},{key:"DOB",label:"D.O.B.",type:"date"},{key:"SSN",label:"ssn",type:"number"},{type:"Button",label:"Add Customer",onClick:async()=>{await r(P.value.customerData),await k(),i.value={...H.value}}}]});return(_,t)=>{const b=v("mToolbar"),D=v("InputText"),I=v("Paginator"),M=v("Skeleton"),j=v("mForm"),q=v("Dialog"),L=V("auto-animate");return a(),l("div",X,[m(b,{items:O.value},null,8,["items"]),f("span",Y,[Z,m(D,{onInput:t[0]||(t[0]=e=>U()),modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),type:"search",placeholder:"Quick Search",class:"p-inputtext-sm flex-grow-1",style:{width:"100%"}},null,8,["modelValue"])]),m(I,{first:u.value.first,"onUpdate:first":t[2]||(t[2]=e=>u.value.first=e),rows:u.value.rows,totalRecords:u.value.totalRecords,template:"FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",onPage:A},null,8,["first","rows","totalRecords"]),c((a(),l("div",ee,[p.value?N("",!0):(a(!0),l(G,{key:0},J(x.value,e=>c((a(),l("div",{key:e.id,class:"m-List-Item pt-1"},[c((a(),l("div",{class:"m-List-Item-Content px-1 mx-1",onClick:ce=>C(d).push({name:"customers",params:{id:e.id}})},[f("div",se,h(e.lastName)+", "+h(e.firstName),1),f("div",ae,h(e.DOB),1)],8,te)),[[L]]),oe])),[[L]])),128)),p.value?(a(),l("div",ne,[m(M,{width:"13rem",height:"3rem",class:"mt-2 mx-1"})])):N("",!0)])),[[L]]),m(q,{visible:i.value.show,"onUpdate:visible":t[4]||(t[4]=e=>i.value.show=e),header:i.value.header},{default:S(()=>[m(j,{modelValue:i.value.customerData,"onUpdate:modelValue":t[3]||(t[3]=e=>i.value.customerData=e),items:i.value.formItems,direction:"vertical"},null,8,["modelValue","items"])]),_:1},8,["visible","header"])])}}},re={class:"flex"},ue={class:"flex-grow-1"},me={__name:"customersView",setup(y){const r=K();return(w,g)=>{const d=v("mCard"),s=V("auto-animate");return a(),l("div",re,[c((a(),R(d,{class:"flex-shrink-1"},{default:S(()=>[m(le)]),_:1})),[[s]]),c((a(),l("div",ue,[C(r).params.id?c((a(),R(d,{key:0},{default:S(()=>[$(h(C(r).params.id)+" ",1),c(m(W,{custID:C(r).params.id,class:"flex-grow-1"},null,8,["custID"]),[[s]])]),_:1})),[[s]]):N("",!0)])),[[s]])])}}};export{me as default};
